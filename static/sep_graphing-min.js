let graphType,priorNodeCircle,priorNodeCircle_ListItem,currentDomainCentralNode,sepEdition,baseURL,svg=d3.select("#graphSVG"),homePageDiv=d3.select("#homePageDiv"),aboutPageDiv=d3.select("#aboutPageDiv"),contactPageDiv=d3.select("#contactPageDiv"),graphPageDiv=d3.select("#graphPageDiv"),errorPageDiv=d3.select("#errorPageDiv"),sidebarLeft=d3.select("#sidebarLeft"),sidebarRight=d3.select("#sidebarRight"),vizLogo=d3.select("#vizLogo"),navBar=d3.select("nav"),pageTitle=d3.select("#pageTitle"),copyright=d3.select("#copyright"),graphMode=d3.select("#graphMode"),graphTip=d3.select("#graphTip"),graphHelp=d3.select("#graphHelp"),selectedDomainArticle=d3.select("#selectedDomainArticle"),articleSearchButton=d3.select("#articleSearchButton"),articleSearchArea=d3.select("#articleSearchArea"),articleSearchType=d3.select("#articleSearchType"),articleSearchFilter=d3.select("#articleSearchFilter"),articleSearchListDiv=d3.select("#articleSearchListDiv"),articleShowAllCheck=d3.select("#articleShowAllCheck"),articleCloseSearchArea=d3.select("#articleCloseSearchArea"),articleTextSearchButton=d3.select("#articleTextSearchButton"),articleDetailsPage=d3.select("#articleDetails"),articleDetailsTip=d3.select("#articleDetailsTip"),domainSearchButton=d3.select("#domainSearchButton"),domainSearchArea=d3.select("#domainSearchArea"),domainSearchFilter=d3.select("#domainSearchFilter"),domainSearchListDiv=d3.select("#domainSearchListDiv"),domainShowAllCheck=d3.select("#domainShowAllCheck"),domainCloseSearchArea=d3.select("#domainCloseSearchArea"),domainSelectedArticle=d3.select("#selectedDomainArticle"),recentSearchDiv=d3.select("#recentSearchDiv"),recentSearchButton=d3.select("#recentSearchButton"),recentSearchArea=d3.select("#recentSearchArea"),recentSearchFilter=d3.select("#recentSearchFilter"),recentSearchListDiv=d3.select("#recentSearchListDiv"),recentShowAllCheck=d3.select("#recentShowAllCheck"),recentCloseSearchArea=d3.select("#recentCloseSearchArea"),getRandomEntry=d3.select("#getRandomEntry"),aboutPageLink=d3.select("#aboutPage"),contactPageLink=d3.select("#contactPage"),aboutNumArticles=d3.select("#aboutNumArticles"),aboutNumLinks=d3.select("#aboutNumLinks"),aboutNumDomains=d3.select("#aboutNumDomains"),aboutAvgWordCount=d3.select("#aboutAvgWordCount"),aboutSEPEdition=d3.select("#sepEdition"),aboutSEPEditionURL=d3.select("#sepEdition"),graphNodes=[],graphLinks=[],searchCache=[],allArticles=[],allDomains=[],allEntries=[],recentSearches=[],svgConfig=initializeParentSVG(svg),simConfig=initializeSimulation(svgConfig),styConfig=initializeStyles(),showAll=!1,neighborNodes=[],linkAngles=[],exploreMode=!1,panelOpacityValue=1,pageTransition=300,json_file="static/sep_network.json";function startVisualization(){loadMenuData()}function setGlobalNodesLinks(e){graphNodes.length=0,graphLinks.length=0,e.nodes.forEach(e=>graphNodes.push(e)),e.links.forEach(e=>graphLinks.push(e))}function initializeParentSVG(e){let t={top:0,right:0,bottom:0,left:0},i=1e3-t.left-t.right,n=900-t.top-t.bottom;return e.attr("viewBox","0 90 "+i+" "+n).attr("preserveAspectRatio","xMidYMid"),e.html(""),{margin:t,areaWidth:1e3,areaHeight:900,width:i,height:n,graphElements:e.append("g").attr("transform",`translate(${i/2},${n/2})`).classed("sepGraphGroup",!0).append("g").classed("graphElements",!0)}}function initializeSimulation(e){let t=e.graphElements.append("g").classed("links",!0),i=e.graphElements.append("g").classed("labels",!0),n=e.graphElements.append("g").classed("relatedLinks",!0),a=e.graphElements.append("g").classed("nodes",!0),o=e.graphElements.append("g").classed("domainLabels",!0),l=d3.forceSimulation();return l.nodes(graphNodes).force("charge",d3.forceManyBody()).force("link",d3.forceLink()).force("center",d3.forceCenter()).force("collide",d3.forceCollide()).force("forceX",d3.forceX()).force("forceY",d3.forceY()).alphaTarget(.98),{links:t,nodes:a,labels:i,relatedLinks:n,domainLabels:o,simulation:l}}function initializeStyles(){return{link:{defaultOpacity:.1,activeOpacity:.3,activeDomainOpacity:.08,inactiveOpacity:.06,inactiveDomainOpacity:.01,strokeColor:"#999",strokeWidth:1},nodeLabel:{defaultOpacity:1,centralNodeDimmedOpacity:.8,neighborNodeOpacity:.25,inArrayOpacity:1,notInArrayOpacity:.03,defaultFontSize:"1.3em",largeGraphFontSize:".5em",defaultRadius:4,strokeColor:"#fff",strokeWidth:.5},linkLines:{articleGraphOpacity:.4,domainGraphOpacity:.5,inactiveOpacity:0},listItems:{defaultOpacity:1,dimmedOpacity:.21}}}function loadMenuData(){d3.json(json_file).then(e=>{let t=0;sepEdition=e.sepData.Edition,baseURL=e.sepData.EditionURL,e.articles.nodes.forEach(e=>{let i=e.title,n=e.id,a=e.primary_domain,o=parseInt(e.word_count.replace(",",""));allArticles.push({title:i,id:n,primary_domain:a}),t+=o}),e.domains.forEach(e=>{let t=e.toLowerCase().replace(/\s+/g,"-");allDomains.push({title:e,id:t,primary_domain:e})}),allDomains.sort((e,t)=>d3.ascending(e.title,t.title)),allEntries=allArticles.concat(allDomains),aboutNumArticles.text(allArticles.length.toLocaleString()),aboutNumLinks.text(e.articles.links.length.toLocaleString()),aboutNumDomains.text(allDomains.length),aboutAvgWordCount.text(parseInt(t/allArticles.length).toLocaleString());let i='<a target="_blank" href="'+baseURL+'/"about.html>'+sepEdition+"</a>";aboutSEPEdition.html(i),setNavigation(),processURL()})}function updateRecentSearch(e,t){if(!recentSearches.includes(e)){"Domain"===t&&(e.title=e.title+" (domain)"),0===recentSearches.filter(t=>t.title===e.title).length&&recentSearches.push(e),recentSearches.length>10&&recentSearches.shift()}}function searchSEP(e){let t="https://plato.stanford.edu/search/searcher.py?query="+e.replace(/\s/g,"+");window.open(t,"_blank")}function setNavigation(){navBar.style("opacity",1).on("end",(function(){l(domainSearchListDiv,allDomains),domainShowAllCheck.property("checked",!0)})),vizLogo.on("mouseover",(function(){isNavFullOpacity()&&activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){isNavFullOpacity()&&showHomePage()})),t("title"),articleSearchButton.on("mouseover",(function(){isNavFullOpacity()&&articleSearchButton.classed("searchButtonActive",!0).style("cursor","pointer")})).on("mouseout",(function(){articleSearchButton.classed("searchButtonActive",!1)})).on("click",(function(){isNavFullOpacity()&&("block"===articleSearchArea.style("display")?i():(o(),articleSearchArea.style("display","block"),articleSearchButton.classed("searchButtonActive",!0),articleSearchListDiv.style("display","block"),articleSearchFilter.node().focus(),articleShowAllCheck.property("checked",!1)))})),articleSearchType.on("change",(function(){t(d3.event.target.value)})),articleTextSearchButton.on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){searchSEP(articleSearchFilter.property("value"))})),articleSearchFilter.on("keyup",(function(){let e=d3.event.target.value;"title"===d3.select('input[name="searchType"]:checked').property("value")&&(0===e.length||""===e.trim()?(l(articleSearchListDiv,[]),showAll=!1):(r("Article",e),showAll=!1))})),articleShowAllCheck.on("click",(function(){let e=articleShowAllCheck.property("checked");e&&(showAll=!0,l(articleSearchListDiv,allArticles)),e||(showAll=!0,l(articleSearchListDiv,[])),articleSearchFilter.node().focus()})),articleCloseSearchArea.on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){i()})),domainSearchButton.on("mouseover",(function(){domainSearchButton.classed("searchButtonActive",!0)})).on("mouseout",(function(){domainSearchButton.classed("searchButtonActive",!1)})).on("click",(function(){isNavFullOpacity()&&("block"===domainSearchArea.style("display")?n():(o(),domainSearchArea.style("display","block"),domainSearchButton.classed("searchButtonActive",!0),domainSearchListDiv.style("display","block"),domainShowAllCheck.property("checked",!0),domainSearchFilter.node().focus(),l(domainSearchListDiv,allDomains)))})),domainSearchFilter.on("keyup",(function(){let e=d3.event.target.value;0===e.length||""===e.trim()?(l(domainSearchListDiv,allDomains),domainShowAllCheck.property("checked",!0)):(domainShowAllCheck.property("checked",!1),r("Domain",e))})),domainShowAllCheck.on("change",(function(){domainShowAllCheck.property("checked")?(l(domainSearchListDiv,allDomains),domainShowAllCheck.property("checked",!0)):(l(domainSearchListDiv,[]),domainShowAllCheck.property("checked",!1)),domainSearchFilter.node().focus()})),domainCloseSearchArea.on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){n()})),recentSearchButton.on("mouseover",(function(){recentSearchButton.classed("searchButtonActive",!0)})).on("mouseout",(function(){recentSearchButton.classed("searchButtonActive",!1)})).on("click",(function(){isNavFullOpacity()&&("block"===recentSearchArea.style("display")?a():(o(),recentSearchArea.style("display","block"),recentSearchButton.classed("searchButtonActive",!0),recentSearchListDiv.style("display","block"),recentShowAllCheck.property("checked",!0),recentSearchFilter.node().focus(),l(recentSearchListDiv,recentSearches),e=!1))})),recentSearchFilter.on("keyup",(function(){let e=d3.event.target.value;0===e.length||""===e.trim()?(l(recentSearchListDiv,recentSearches),recentShowAllCheck.property("checked",!0)):(recentShowAllCheck.property("checked",!1),r("Recent",e))})),recentShowAllCheck.on("change",(function(){recentShowAllCheck.property("checked")?(l(recentSearchListDiv,recentSearches),recentShowAllCheck.property("checked",!0)):(l(recentSearchListDiv,[]),recentShowAllCheck.property("checked",!1)),recentSearchFilter.node().focus()})),recentCloseSearchArea.on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){a()})),getRandomEntry.on("mouseover",(function(){isNavFullOpacity()&&activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){isNavFullOpacity()&&(o(),getRandom())})),aboutPageLink.on("mouseover",(function(){isNavFullOpacity()&&activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){isNavFullOpacity()&&showAboutPage()})),contactPageLink.on("mouseover",(function(){isNavFullOpacity()&&activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){isNavFullOpacity()&&showContactPage()})),copyright.on("mouseover",(function(){isNavFullOpacity()&&activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){isNavFullOpacity()&&showContactPage()}));let e=!1;function t(e){let t=d3.select("#titleSearchTip"),i=d3.select("#textSearchTip");"title"===e&&(t.transition().duration(pageTransition).style("display","block").style("opacity",1),i.transition().duration(pageTransition).style("opacity",0).style("display","none"),articleTextSearchButton.transition().duration(pageTransition).style("opacity",0)),"text"===e&&(t.transition().duration(pageTransition).style("opacity",0).style("display","none"),i.transition().duration(pageTransition).style("display","block").style("opacity",1),articleTextSearchButton.transition().duration(pageTransition).style("opacity",1)),articleSearchFilter.property("value",""),l(articleSearchListDiv,[]),articleSearchFilter.node().focus()}function i(){articleSearchArea.style("display","none"),articleSearchListDiv.html(""),articleSearchFilter.property("value",""),articleShowAllCheck.property("checked",!1)}function n(){domainSearchArea.style("display","none"),domainSearchFilter.property("value",""),domainShowAllCheck.property("checked",!0)}function a(){recentSearchArea.style("display","none"),recentSearchFilter.property("value",""),recentShowAllCheck.property("checked",!0)}function o(){i(),n(),a()}function l(t,o){t.html(""),t.transition().duration(pageTransition).style("display","block").style("opacity",1),t.append("ul").selectAll(".searchResults").data(o).enter().append("li").append("a").text((function(e){return e.title})).style("color",(function(e){return color(e.primary_domain)})).classed("searchResults",!0).classed("dropDownMenuListItem",!0).classed("dropDownMenuLink",!0).exit().remove(),d3.selectAll(".searchResults").on("focusin",(function(){e=!0})).on("click",(function(){let o=t.node().id,l=d3.select(this).datum().title;if(o.includes("article")&&(showArticleGraph(l),i()),o.includes("domain")&&(showDomainGraph(l),n()),o.includes("recent")){let e=l.indexOf(" (domain)");-1===e?showArticleGraph(l):showDomainGraph(l.substring(0,e)),a()}e=!1}))}function r(e,t){let i;switch(e){case"Article":i="*ALL*"===t?allArticles.map(e=>e.title):allArticles.filter(e=>e.title.toLowerCase().includes(t.toLowerCase())),searchDiv=articleSearchListDiv;break;case"Domain":i=allDomains.filter(e=>e.title.toLowerCase().includes(t.toLowerCase())),searchDiv=domainSearchListDiv;break;case"Recent":i=recentSearches.filter(e=>e.title.toLowerCase().includes(t.toLowerCase())),searchDiv=recentSearchListDiv;break}var n;i.length>0?l(searchDiv,i):((n=searchDiv).html(""),n.append("h2").text("Nothing Found").classed("searchFilterResults",!0))}}function isNavFullOpacity(){let e=!0;return 1!==parseFloat(navBar.style("opacity"))&&(e=!1),e}function setPageTitle(e,t,i){let n;n=void 0!==i?e+" (Domain Graph)":e,pageTitle.select("h1").text(n).style("color",(function(e){return color(t)}))}function showContentPage(e,t){hideSidebars(),hidePage(homePageDiv),hidePage(graphPageDiv),hidePage(aboutPageDiv),hidePage(contactPageDiv),hidePage(errorPageDiv),e.style("display","block").transition().duration(pageTransition).style("opacity",1),setPageTitle(t,"Default Page")}function hidePage(e){"block"===e.style("display")&&(e.transition().duration(pageTransition).style("opacity",0),e.style("display","none"))}function hideSidebars(){sidebarLeft.transition().duration(pageTransition).style("opacity",0),sidebarRight.transition().duration(pageTransition).style("opacity",0)}function showSidebars(){sidebarLeft.transition().duration(pageTransition).style("opacity",1),sidebarRight.transition().duration(pageTransition).style("opacity",1)}function showGraphPage(){hidePage(homePageDiv),hidePage(aboutPageDiv),hidePage(contactPageDiv),hidePage(errorPageDiv),showSidebars(),graphPageDiv.classed("panelBG_graph","true").style("display","block").transition().duration(pageTransition).style("opacity",1)}function showHomePage(){updateBrowser("","Visualizing SEP: An interactive data visualization of the Stanford Encyclopedia of Philosophy"),showContentPage(homePageDiv,"Welcome to Visualizing SEP")}function showAboutPage(){let e="About Visualizing SEP";updateBrowser("/about",e),showContentPage(aboutPageDiv,e)}function showContactPage(){let e="Contact Information";showContentPage(contactPageDiv,e),updateBrowser("/contact",e)}function show404Page(){let e="404: Page Not Found";showContentPage(errorPageDiv,e),updateBrowser("/404",e)}function processURL(){let e=window.location.hash;-1===e.indexOf("entries")&&-1===e.indexOf("domain")?""===e||"#"===e||"/#"===e||"/#/"===e||"#/"===e?showHomePage():"#/about"===e||"#/about/"===e?showAboutPage():"#/contact"===e||"#/contact/"===e?showContactPage():show404Page():(-1!==e.indexOf("entries")&&processArticle(e),-1!==e.indexOf("domain")&&processDomain(e))}function processArticle(e){let t=e.indexOf("#")+1,i=e.substring(t),n=allArticles.filter(e=>e.id===i);0!==n.length?showArticleGraph(n[0].title):show404Page(e)}function processDomain(e){let t=e.indexOf("#/domain/")+9,i=e.substring(t),n=allDomains.filter(e=>e.id===i);0!==n.length?showDomainGraph(n[0].title):show404Page(e)}function updateBrowser(e,t){let i="#"+e;i!==location.hash&&(window.history.pushState({id:i},null,i),document.title=t)}function setNavTip(e){"On"===e?graphTip.transition().duration(pageTransition).style("opacity",1).style("display","block"):graphTip.transition().duration(pageTransition).style("opacity",0).style("display","none")}function setGraphMode(e){graphMode.classed("graphModeHelpCallout",!0).text("Reset Graph").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){setGraphMode("Hover")})),"Hover"===e&&(exploreMode=!1,resetDomainMenuOpacity(),resetDisplayDefaultsDomainGraph(),resetDisplayDefaultsArticleGraph(),graphMode.transition().duration(pageTransition).style("opacity",0)),"Explore"===e&&(exploreMode=!0,graphMode.transition().duration(pageTransition).style("opacity",1))}function setGraphType(e){let t,i;"Article"===e&&(t="Quick Tip: <strong>Single-click</strong> a node or title to freeze graph; <strong>Single-click+SHIFT Key</strong> to display Article Details; <strong>Double-click</strong> to load new graph.",i="#graphHelpArticle"),"Domain"===e&&(t="Quick Tip: <strong>Single-click</strong> a node or title to freeze graph; <strong>Single-click+SHIFT Key</strong> to display Article Details; <strong>Double-click</strong> to load new Article Graph.",i="#graphHelpDomain"),graphTip.html(t),graphHelp.classed("graphModeHelpCallout",!0).classed("graphHelpBGImage",!0).on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){toggleHelpPage(i)})),graphType=e}function dimScreen(e){let t=300;switch(navBar.transition(t).style("opacity",.25),e){case"help":sidebarLeft.transition(t).style("opacity",.25),sidebarRight.transition(t).style("opacity",.25),pageTitle.transition(t).style("opacity",.25);break;case"details":d3.select("#articleIntroParagraphPanel").transition(t).style("opacity",.25),d3.select("#domainIntroPanel").transition(t).style("opacity",.25);break}}function resetScreen(){let e=200;panelOpacityValue=1,hideAllHelpPages(),navBar.transition(e).style("opacity",1),pageTitle.transition(e).style("opacity",1),sidebarLeft.transition(e).style("opacity",1),sidebarRight.transition(e).style("opacity",1),d3.select("#articleIntroParagraphPanel").transition(e).style("opacity",1),d3.select("#domainIntroPanel").transition(e).style("opacity",1)}function displayHelpPage(e){dimScreen("help"),hideAllHelpPages(),d3.select(e).classed("scrollbars",!0).style("display","block").on("click",(function(){d3.event.shiftKey&&(clearSelections(),hideHelpPage(e),clearSelections())})).transition().duration(pageTransition).style("opacity",1);let t=d3.select(e).append("div").text("Close Page").classed("closePageArea",!0).classed("graphModeHelpCallout",!0);d3.selectAll(".graphInstructionsPageHeading").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){hideHelpPage(e)})),d3.selectAll(".closePageArea").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){t.remove(),hideHelpPage(e)}))}function hideHelpPage(e){d3.select(e).transition().duration(pageTransition).style("opacity",0),d3.select(e).style("display","none"),resetScreen()}function hideAllHelpPages(){d3.selectAll(".graphInstructionArea").style("opacity",0).style("display","none")}function toggleHelpPage(e){"none"===d3.select(e).style("display")?displayHelpPage(e):hideHelpPage(e)}function showArticleGraph(e){d3.json(json_file).then(t=>{let i=getArticleData(t,e);setGlobalNodesLinks(i);let n=graphNodes[0];showGraphPage(),resetScreen(),setGraphMode("Hover"),setGraphType("Article"),drawArticleSimulation(t,n),setPageTitle(e,i.primaryDomain),updateSidebarsArticle(t,n),updateBrowser(i.id,e),resetDisplayDefaultsDomainGraph(),resetDisplayDefaultsArticleGraph(),d3.select(".mainDomainNode").remove(),updateRecentSearch({title:e,primary_domain:i.primaryDomain},"Article"),showAll=!1,clearSelections()})}function getArticleData(e,t){let i={},n=searchCache.find(({article:e})=>e===t);return i=n||getArticleDataFromJSON(e,t),i}function getArticleDataFromJSON(e,t){let i=e.articles.nodes.filter(e=>e.title===t),n=i[0].id,a=i[0].primary_domain,o=[],l=[];e.articles.links.forEach(e=>{e.source===n&&o.push(e.target),e.target===n&&l.push(e.source)});let r=intersection(o,l),s=symmetricDifference(r,o),c=symmetricDifference(r,l),d=combineLinks(n,r,s,c),u=[];u.push(i[0]);let p={};d.forEach(t=>{e.articles.nodes.forEach(e=>{e.id===t.target&&(u.push(e),p[e.primary_domain]>0?p[e.primary_domain]++:p[e.primary_domain]=1)})});let m=Object.entries(p);m.sort((e,t)=>d3.ascending(e[0],t[0]));let h={article:t,id:n,nodes:u,links:d,biLinks:r,inLinks:c,outLinks:s,linkDomains:m,primaryDomain:a};return searchCache.push(h),h}function drawArticleSimulation(e,t){graphNodes[0];let i=graphNodes.length;d3.selectAll(".mainArticleLabelArea").remove(),link=simConfig.links.selectAll(".link").data(graphLinks,(function(e){return`${e.source}-${e.target}`})).order().attr("dir",(function(e){return e.dir})).attr("target",(function(e){return e.target})),link.exit().remove(),link=link.enter().append("line").attr("stroke",styConfig.link.strokeColor).attr("stroke-width",styConfig.link.strokeWidth).attr("opacity",styConfig.link.defaultOpacity).attr("dir",(function(e){return e.dir})).attr("nodeID",(function(e){return e.target})).classed("link",!0).merge(link),label=simConfig.labels.selectAll(".label").data(graphNodes,(function(e){return e.title})).attr("fill-opacity",styConfig.nodeLabel.defaultOpacity).order().classed("mainArticleLabel",(function(e,t){return 0===t})).attr("fill",(function(e){return color(e.primary_domain)})),label.exit().remove(),label=label.enter().append("text").text((function(e){return e.title})).attr("fill-opacity",styConfig.nodeLabel.defaultOpacity).attr("fill",(function(e){return color(e.primary_domain)})).attr("nodeID",(function(e){return e.id})).classed("label",!0).classed("mainArticleLabel",(function(e,t){return 0===t})).merge(label),label.on("mouseover",(function(){mouseOverArticleNode(this,e,"fill-opacity")})).on("mouseout",(function(){mouseOutArticleNode(this,e,"fill-opacity")})).on("click",(function(){sngClickArticleNode(this,e,"fill-opacity")})).on("dblclick",(function(){dblClickArticleNode(this,"fill-opacity")})),node=simConfig.nodes.selectAll(".node").data(graphNodes,(function(e){return e.id})).order().attr("r",styConfig.nodeLabel.defaultRadius).attr("fill",(function(e){return color(e.primary_domain)})).classed("mainArticleNode",(function(e,t){return 0===t})),node.exit().remove(),node=node.enter().append("circle").attr("r",styConfig.nodeLabel.defaultRadius).attr("fill",(function(e){return color(e.primary_domain)})).attr("stroke",styConfig.nodeLabel.strokeColor).attr("stroke-width",styConfig.nodeLabel.strokeWidth).attr("nodeID",(function(e){return e.id})).style("opacity",styConfig.nodeLabel.defaultOpacity).classed("node",!0).classed("mainArticleNode",(function(e,t){return 0===t})).merge(node),node.on("mouseover",(function(){mouseOverArticleNode(this,e,"opacity")})).on("mouseout",(function(){mouseOutArticleNode(this,e,"opacity")})).on("click",(function(){sngClickArticleNode(this,e,"opacity")})).on("dblclick",(function(){dblClickArticleNode(this,"opacity")}));let n=0;simConfig.simulation.on("tick",(function(){n<300?(link.attr("x1",(function(e){return 0})).attr("y1",(function(e){return 0})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y})).attr("linkIndex",(function(e,t){return j=t+1,linkAngles[j]=angle(0,0,e.target.x,e.target.y),t})),node.attr("cx",(function(e){return 0===e.index?0:e.x})).attr("cy",(function(e){return 0===e.index?0:e.y})),label.attr("x",(function(e){return 0===e.index?0:setArticleXpos(e.x,this.getBBox().width)})).attr("y",(function(e){return 0===e.index?-10:e.y+4})).attr("transform",(function(e,t){return 0===t?"rotate(0)":rotateLabel(t,e.x,e.y)}))):simConfig.simulation.stop(),n++})),simConfig.simulation.force("charge").strength((function(){return forceStrength(i)})),simConfig.simulation.force("link").id((function(e){return e.id})).distance(225).links(graphLinks),simConfig.simulation.force("forceX").strength(0),simConfig.simulation.force("forceY").strength(0),simConfig.simulation.force("collide").radius(3),simConfig.simulation.nodes(graphNodes),simConfig.simulation.alpha(1).restart(),setArticleGraphMainLabel(t)}function setArticleGraphMainLabel(e){let t=d3.select(".mainArticleLabel").datum(),i=[{text:t.title,primaryDomain:t.primary_domain}],n=simConfig.labels.append("g").classed("mainArticleLabelArea",!0);n.html(""),n.style("display","block"),(new d3plus.TextBox).data(i).select(".mainArticleLabelArea").y(-15).x(-100).fontFamily("proxima-nova, sans-serif").fontSize(18).fontColor((function(e){return color(e.primaryDomain)})).verticalAlign("top").textAnchor("middle").width(200).lineHeight(20).height(150).render(),d3.select(".d3plus-textBox").style("opacity",1),n.on("mouseover",(function(){d3.event.shiftKey&&(activateItemLink(this),clearSelections())})).on("mouseout",(function(){exploreMode||deActivateItemLink(this)})).on("click",(function(){d3.event.shiftKey&&(showArticleDetailsPage(e),clearSelections())}))}function clearSidebar(e){e.html("")}function updateSidebarsArticle(e,t){updateSideBarLeft_ArticleMain(t,"Main"),updateSideBarRight_ArticleMain(e,t)}function updateSideBarLeft_ArticleMain(e,t){if(e){clearSidebar(sidebarLeft);let i=sidebarLeft.append("div");setArticleIntroParagraph(i,t,e),setArticleDomainDetails(i,e)}}function setArticleIntroParagraph(e,t,i){let n=e.append("div");n.classed("panelBG",!0).attr("id","articleIntroParagraphPanel").style("opacity",.25).style("display","none"),n.transition().duration(500).ease(d3.easeLinear).style("opacity",panelOpacityValue).style("display","block");let a=i.title;n.append("h2").text(a).attr("id","articlePreviewTitle").classed("panelHeading",!0).style("font-size","bigger").style("color",(function(){return color(i.primary_domain)}));let o=n.append("div").attr("id","articleIntroParagraphContentArea").style("display","block"),l=getParagraphDataHTML(i.preamble_text,600),r=(o.append("div").html(l).classed("panelParagraphText",!0),o.append("div").classed("articleDetailsBG",!0));r.append("p").classed("introParagraphText",!0).classed("articleDetailsBG_textColor",!0).text("Article Details"),r.on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){toggleArticleDetailsPage(i)}))}function showArticleDetailsPage(e){panelOpacityValue=.25,clearSelections(),setArticleDetailsPage(e),articleDetailsPage.transition().duration(pageTransition).style("display","block").style("opacity",1),"Article"===graphType&&(toggleArticleListContent("on"),toggleLinkDirectionContent("off"),toggleLinkDomainContent("off")),clearSelections(),dimScreen("details")}function hideArticleDetailsPage(){articleDetailsPage.transition().duration(pageTransition).style("opacity",0).style("display","none"),resetScreen()}function toggleArticleDetailsPage(e){"block"===articleDetailsPage.style("display")?hideArticleDetailsPage():showArticleDetailsPage(e)}function setArticleDetailsPage(e){articleDetailsPage.html("");let t=articleDetailsPage.append("div"),i=(t.append("h2").text(e.title).classed("panelHeading",!0).classed("graphInstructionsPageHeading",!0).style("color",(function(){return color(e.primary_domain)})),[`<td>Author(s):</td><td>${e.author}</td>`,`<td>Pub&nbsp;Date:</td><td> ${e.pubdate.replace(/;/g,";<br>")}</td>`,`<td>Word&nbsp;Count:</td><td> ${e.word_count}</td>`,`<td>SEP Link:</td><td><a href="${e.article_url}" target="_blank">${e.title}</a></td>`]),n=t.append("div").attr("id","detailsAndTOCDiv"),a=(n.append("h2").text("Article Details").style("color",(function(){return color(e.primary_domain)})),n.append("div").attr("id","articleDetailsTableDiv").append("table").classed("table",!0).classed("table-sm",!0).classed("table-bordered",!0).classed("table-hover",!0).classed("table-dark",!0).classed("table-hover",!0).style("margin","0").style("padding","0"));a.append("tbody"),a.selectAll("tr").data(i).enter().append("tr").html(e=>e).classed("panelListItem",!0).style("margin","0").style("padding","0").style("text-indent","0"),n.append("h2").text("Table of Contents").style("color",(function(){return color(e.primary_domain)})).style("margin-top","-1em").append("p").text("(Links to SEP article sections)").style("font-size","smaller").style("color",(function(){return color(e.primary_domain)}));n.append("div").attr("id","exploreTOCContentArea").append("div").html(e.toc).attr("id","tocArea");d3.select("#toc").classed("scrollbars",!0);let o=t.append("div").attr("id","preambleArea").classed("scrollbars",!0),l=getParagraphDataHTML(e.preamble_text,1750);o.append("div").html(l).classed("panelParagraphText",!0),t.append("div").text("Close Page").classed("closePageArea",!0).classed("graphModeHelpCallout",!0),t.append("div").html("<strong>MouseOver</strong> article titles in the Right Sidebar to update Article Details; <strong>Single-click+SHIFT Key</strong> to close this page. ").attr("id","articleDetailsTip");t.on("click",(function(){d3.event.shiftKey&&(hideArticleDetailsPage(),clearSelections())})),d3.selectAll(".graphInstructionsPageHeading").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){hideArticleDetailsPage()})),d3.selectAll(".closePageArea").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){hideArticleDetailsPage()}))}function getParagraphDataHTML(e,t){let i="";if(void 0!==e){if(""!==e)if(e.length>t){let n=e.substring(0,t),a=n.lastIndexOf("."),o=n.lastIndexOf("?"),l=n.lastIndexOf(","),r=n.lastIndexOf(";"),s=Math.max(a,o,l,r);-1!==a?(a>o&&(finalParaText=n.substring(0,a+1)),a<o&&(finalParaText=n.substring(0,o+1))):finalParaText=n.substring(0,s)+" ...",i=1750===t?"<p>"+finalParaText+'</p><p class="panelDispayCut">~ Abstract Shortened For Display ~</p>':"<p>"+finalParaText+"</p>"}else i="<p>"+e+"</p>"}else i="";return i}function setArticleDomainDetails(e,t){let i=e.append("div").classed("panelBG",!0).attr("id","articleDomainDetailsPanel"),n=t.primary_domain,a=t.domain_tags.split(","),o=a.indexOf(n);a.splice(o,1),a.sort((e,t)=>d3.ascending(e,t)),a.unshift(n);let l,r=[];a.forEach((function(e,t){let i,n=`<td><span class="domainItem" style="color:${color(e)}">${e}</span></td>`;0===t&&(i='<td class="domainTypeText">Primary&nbsp;Domain:</td>'),1===t&&(i='<td class="domainTypeText">Other&nbsp;Domain(s):</td>'),t>1&&(i='<td class="domainTypeText"></td>'),r.push(i+n)})),l=1===r.length?"Article Domain":"Article Domains";i.append("h2").text(l).attr("id","domainListHeading").classed("panelHeading",!0);let s=i.append("div").attr("id","domainListContentArea").style("display","block");s.append("table").classed("table",!0).classed("table-sm",!0).classed("table-borderless",!0).classed("detailsTable",!0).style("margin-left",".5em").style("padding-right","1em").append("tbody").selectAll("tr").data(r).enter().append("tr").html(e=>e).style("margin","0").style("padding","0").exit().remove(),setPanelHelp(s,"Article Domains Help","panelHelpLeftSideBar","#articleDomainsHelp").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){toggleHelpPage("#graphHelpArticleDomains")})),d3.selectAll(".domainItem").on("mouseover",(function(){activateItemLink(this),d3.select(this).style("text-decoration","underline")})).on("mouseout",(function(){deActivateItemLink(this),d3.select(this).style("text-decoration","none")})).on("click",(function(){let e=d3.select(this).node().innerHTML;resetScreen(),showDomainGraph(e)}))}function toggleArticleIntroContent(e){let t=d3.select("#articleIntroParagraphContentArea");"on"===e?t.style("display","block"):"off"===e&&t.style("display","none"),clearSelections()}function toggleDomainDetailsContent(e){let t=d3.select("#domainListContentArea");d3.select("#domainListHeading");"on"===e?t.style("display","block"):"off"===e&&t.style("display","none"),clearSelections()}function updateSideBarRight_ArticleMain(e,t){if(t){let i=getArticleData(e,t.title);clearSidebar(sidebarRight);let n=sidebarRight.append("div");setLinkCountPanel(n,i,e),setArticleListPanel(n,i,e),setLinkDomainPanel(n,i),setLinkDirectionPanel(n,i)}}function setLinkCountPanel(e,t,i){e.append("div").classed("panelBG",!0).classed("linkCountDiv",!0).append("h2").html(`<span class="badge badge-pill badge-light">${t.links.length}</span> Linked Articles`).classed("linkCountText",!0)}function setArticleListPanel(e,t,i){let n=e.append("div").classed("panelBG",!0).attr("id","articleListOfAllArticlesPanel"),a=n.append("h2").text("List of Articles").attr("id","articleListHeading").classed("panelHeading",!0).classed("toggleOffBG_User",!0);n.append("p").text("").style("display","block").attr("id","articleHiddenMessage").classed("panelParagraphText",!0);let o=n.append("div").attr("id","articleListContentArea").classed("scrollbars",!0).style("display","none"),l=[];t.nodes.forEach(e=>{0!==e.index&&l.push(e)}),l.sort((e,t)=>d3.ascending(e.title,t.title)),o.append("ul").selectAll(".linkArticlesListItem").data(l).enter().append("li").html((function(e){return""+e.title})).style("color",(function(e){return color(e.primary_domain)})).classed("linkArticlesListItem",!0).classed("panelListItem",!0).exit().remove(),setPanelHelp(n,"List of Articles Help","panelHelpRightSideBar","#listOfArticlesHelp").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){toggleHelpPage("#graphHelpListOfArticles")}));let r=d3.selectAll(".linkArticlesListItem");graphNodes[0];r.on("mouseover",(function(){mouseOverArticleNode(this,i,"opacity")})).on("mouseout",(function(){mouseOutArticleNode(this,i,"opacity")})).on("click",(function(){sngClickArticleNode(this,i,"opacity")})).on("dblclick",(function(){dblClickArticleNode(this,"opacity")})),a.on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){let e=o.style("display");"block"===e?(toggleArticleListContent("off"),toggleLinkDirectionContent("on"),toggleLinkDomainContent("on")):"none"===e&&(toggleArticleListContent("on"),toggleLinkDirectionContent("off"),toggleLinkDomainContent("off"))}))}function showAricleListContent(){}function toggleArticleListContent(e){let t=d3.select("#articleListHeading"),i=d3.select("#articleListContentArea"),n=d3.select("#articleHiddenMessage");"on"===e?(i.transition().duration(200).style("display","block"),n.transition().duration(200).style("display","none"),t.classed("toggleOnBG_User",!0).classed("toggleOffBG_User",!1)):"off"===e&&(i.transition().duration(200).style("display","none"),n.transition().duration(200).style("display","block"),t.classed("toggleOnBG_User",!1).classed("toggleOffBG_User",!0)),clearSelections()}function setLinkDirectionPanel(e,t){let i=e.append("div").classed("panelBG",!0).attr("id","articleLinkDirectionsPanel"),n=(i.append("h2").text("Link Directions").attr("id","linkDirectionHeading").classed("panelHeading",!0),i.append("div").attr("id","linkDirectionContentArea").attr("display","block"));linkItems=[`<span class="badge badge-pill badge-light badge-adjust">${t.biLinks.size}</span> Bi-Directional Links`,`<span class="badge badge-pill badge-light badge-adjust">${t.inLinks.size}</span> In-Coming Links`,`<span class="badge badge-pill badge-light badge-adjust">${t.outLinks.size}</span> Out-Going Links`],n.append("ul").selectAll(".linkDirListItem").data(linkItems).enter().append("li").html((function(e){return e})).classed("linkDirListItem",!0).classed("panelListItem_numbered",!0).exit().remove(),setPanelHelp(i,"Link Directions Help","panelHelpRightSideBar","#linkDirectionHelp").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){toggleHelpPage("#graphHelpLinkDirections")})),d3.selectAll(".linkDirListItem").on("mouseover",(function(){activateItemLink(this),exploreMode||(activateLinkDirDomItem(".linkDirListItem",this,"normal"),displayLinkDirectionArticles(this,t))})).on("mouseout",(function(){deActivateItemLink(this),exploreMode||resetDisplayDefaultsArticleGraph()})).on("click",(function(){activateItemLink(this),"bold"===d3.select(this).style("font-weight")?(resetDisplayDefaultsArticleGraph(),setGraphMode("Hover")):(displayLinkDirectionArticles(this,t),activateLinkDirDomItem(".linkDirListItem",this,"bold"),activateLinkDirDomItem(".linkDomainListItem",this,"normal"),setGraphMode("Explore"))}))}function activateLinkDirDomItem(e,t,i){d3.selectAll(e).each((function(e,n){t===this?d3.select(this).style("font-weight",i).transition().duration(200).style("opacity",styConfig.listItems.defaultOpacity):d3.select(this).style("font-weight","normal").transition().duration(200).style("opacity",styConfig.listItems.dimmedOpacity)}))}function displayLinkDirectionArticles(e,t){let i=d3.select(e).datum(),n=i.lastIndexOf("</span>")+7;switch(i.trim().substring(n,n+3).trim()){case"Bi":focusOnLinkAnalysis(Array.from(t.biLinks));break;case"In":focusOnLinkAnalysis(Array.from(t.inLinks));break;case"Ou":focusOnLinkAnalysis(Array.from(t.outLinks));break}}function toggleLinkDirectionContent(e){d3.select("#linkDirectionHeading");let t=d3.select("#linkDirectionContentArea");"on"===e?t.style("display","block"):"off"===e&&t.style("display","none"),clearSelections()}function setLinkDomainPanel(e,t){let i=e.append("div").classed("panelBG",!0).attr("id","articleLinkDomainsPanel");i.append("h2").text("Link Primary Domains").attr("id","linkDomainHeading").classed("panelHeading",!0);i.append("div").attr("id","linkDomainContentArea").attr("display","block").classed("scrollbars",!0).append("ul").selectAll(".linkDomainListItem").data(t.linkDomains).enter().append("li").html((function(e){return`<span class="badge badge-pill badge-light">${e[1]}</span>  ${e[0]}`})).style("color",(function(e){return color(e[0])})).classed("linkDomainListItem",!0).classed("panelListItem_numbered",!0).exit().remove(),setPanelHelp(i,"Link Domain Help","panelHelpRightSideBar","#linkDomainHelp").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){toggleHelpPage("#graphHelpLinkDomains")})),d3.selectAll(".linkDomainListItem").on("mouseover",(function(){activateItemLink(this);let e=getDomainLinksInArticle(d3.select(this).datum());exploreMode||(activateLinkDirDomItem(".linkDomainListItem",this,"normal"),focusOnLinkAnalysis(e))})).on("mouseout",(function(){deActivateItemLink(this),exploreMode||resetDisplayDefaultsArticleGraph()})).on("click",(function(){if(activateItemLink(this),"bold"===d3.select(this).style("font-weight"))resetDisplayDefaultsArticleGraph(),setGraphMode("Hover");else{focusOnLinkAnalysis(getDomainLinksInArticle(d3.select(this).datum())),activateLinkDirDomItem(".linkDirListItem",this,"normal"),activateLinkDirDomItem(".linkDomainListItem",this,"bold"),setGraphMode("Explore")}}))}function toggleLinkDomainContent(e){d3.select("#linkDomainHeading");let t=d3.select("#linkDomainContentArea");"on"===e?t.transition().duration(200).style("display","block"):"off"===e&&t.transition().duration(200).style("display","none"),clearSelections()}function setPanelHelp(e,t,i,n){return e.append("p").classed("calloutBG",!0).classed("panelHelp",!0).classed("panelHelpBGImage",!0).classed(i,!0).attr("id",n)}function activateItemLink(e,t){let i=d3.select(e).style("cursor","pointer");void 0!==t&&i.style("font-weight",t)}function deActivateItemLink(e,t){d3.select(e).style("cursor","auto").classed("domainMainNode",!1),void 0!==t&&d3.select(e).style("font-weight",t)}function getDomainLinksInArticle(e){let t=[];return graphNodes.filter(i=>{i.primary_domain===e[0]&&t.push(i.id)}),t}function setClickTargetActive(e){let t=d3.selectAll(".label").filter((function(t,i){return t.id===e})),i=d3.selectAll(".linkArticlesListItem").filter((function(t,i){return t.id===e}));t.transition().duration(200).style("font-weight","bold").attr("fill-opacity",styConfig.nodeLabel.defaultOpacity),i.transition().duration(200).style("font-weight","bold").style("opacity",styConfig.listItems.defaultOpacity)}function dblClickArticleNode(e,t){let i=d3.select(e);"fill-opacity"===t&&i.style(t)>styConfig.nodeLabel.notInArrayOpacity&&0!==i.datum().index&&dblClickArticleAction(i),"opacity"===t&&i.style(t)>styConfig.listItems.dimmedOpacity&&0!==i.datum().index&&dblClickArticleAction(i),hideArticleDetailsPage(),clearSelections()}function dblClickArticleAction(e){e.style("cursor","pointer"),resetDisplayDefaultsArticleGraph(),showArticleGraph(e.datum().title)}function sngClickArticleNode(e,t,i){let n=d3.select(e);"fill-opacity"===i&&n.style(i)>styConfig.nodeLabel.notInArrayOpacity&&0!==n.datum().index&&sngClickArticleAction(e,t,n),"opacity"===i&&n.style(i)>styConfig.listItems.dimmedOpacity&&0!==n.datum().index&&sngClickArticleAction(e,t,n)}function sngClickArticleAction(e,t,i){if(activateItemLink(e),d3.event.shiftKey){clearSelections(),d3.select("#articlePreviewTitle").node().innerHTML!==i.datum().title&&updateSideBarLeft_ArticleMain(i.datum(),"Preview"),showArticleDetailsPage(i.datum()),clearSelections()}else if("normal"===i.style("font-weight")){getRelatedArticles(t,i.datum());resetListItemDefaults(".linkArticlesListItem"),resetListItemDefaults(".linkDomainListItem"),resetListItemDefaults(".linkDirListItem"),focusOnArticleNode(t,i.datum()),updateSidebarTitleOpacity(t,i.datum()),setClickTargetActive(i.datum().id),setNavTip("On"),setGraphMode("Explore"),clearSelections()}else i.transition().duration(200).style("font-weight","normal"),setGraphMode("Hover"),setNavTip("Off")}function mouseOverArticleNode(e,t,i){let n=d3.select(e);"fill-opacity"===i&&n.style(i)>styConfig.nodeLabel.notInArrayOpacity&&0!==n.datum().index&&mouseOverArticleActions(e,t,n),"opacity"===i&&n.style(i)>styConfig.listItems.dimmedOpacity&&0!==n.datum().index&&mouseOverArticleActions(e,t,n)}function mouseOverArticleActions(e,t,i){activateItemLink(e),setArticleDetailsPage(i.datum());let n=d3.select("#articlePreviewTitle").node().innerHTML,a=i.datum().title;exploreMode||(focusOnArticleNode(t,i.datum()),setNavTip("On")),n!==a&&updateSideBarLeft_ArticleMain(i.datum(),"Preview")}function mouseOutArticleNode(e,t,i){deActivateItemLink(e);let n=d3.select(e),a=graphNodes[0],o=d3.selectAll(".label").filter((function(e,t){return"bold"===d3.select(this).style("font-weight")}));"fill-opacity"===i&&n.style(i)>styConfig.nodeLabel.notInArrayOpacity&&mouseOutArticleAction(a,o),"opacity"===i&&n.style(i)>styConfig.listItems.dimmedOpacity&&mouseOutArticleAction(a,o)}function mouseOutArticleAction(e,t){if(exploreMode||(resetDisplayDefaultsArticleGraph(),updateSideBarLeft_ArticleMain(e,"Main")),exploreMode){let e=d3.select("#articlePreviewTitle").node().innerHTML,i=t.datum().title;t.data().length>0&&e!==i&&updateSideBarLeft_ArticleMain(t.datum(),"Preview")}}function getNodeCenter(e){return d3.selectAll(".node").filter((function(t,i){return t.id===e.id}))}function getRelatedArticles(e,t){let i=getArticleData(e,t.title).nodes.map(e=>e.id),n=intersection(graphNodes.map(e=>e.id),i),a=[];return n.forEach(e=>{graphNodes.forEach(t=>{0!==t.index&&e===t.id&&a.push(t)})}),a.sort((e,t)=>d3.ascending(e.title,t.title)),a}function focusOnArticleNode(e,t){let i=getRelatedArticles(e,t),n=simConfig.relatedLinks;n.html("");let a=getNodeCenter(t).attr("cx"),o=getNodeCenter(t).attr("cy"),l=n.selectAll(".relatedLinkLines").data(i);l.exit().remove(),l=l.enter().append("line").attr("x1",a).attr("y1",o).attr("x2",(function(e){return getNodeCenter(e).attr("cx")})).attr("y2",(function(e){return getNodeCenter(e).attr("cy")})).classed("relatedLinkLines",!0).style("stroke",(function(){return color(t.primary_domain)})).style("opacity",styConfig.linkLines.articleGraphOpacity).merge(l);let r=i.map(e=>e.id);d3.selectAll(".link").each((function(e,i){d3.select(this).transition().duration(200).attr("opacity",(function(e){return e.target.id===t.id?styConfig.link.activeOpacity:styConfig.link.inactiveOpacity}))})),d3.selectAll(".label").each((function(e,i){d3.select(this).transition().duration(200).attr("fill-opacity",(function(e){return setNodeLabelOpacity(e,r,t)})).style("font-weight","normal")})),d3.selectAll(".node").each((function(e,i){d3.select(this).transition().duration(200).style("opacity",(function(e){return setNodeLabelOpacity(e,r,t)}))}))}function updateSidebarTitleOpacity(e,t){let i=getRelatedArticles(e,t).map(e=>e.id);d3.selectAll(".linkArticlesListItem").each((function(e,n){let a=d3.select(this);i.includes(e.id)&&e.id===t.id&&a.transition().duration(200).style("opacity",styConfig.listItems.defaultOpacity).style("font-weight","normal").style("text-decoration","none"),i.includes(e.id)&&e.id!==t.id&&a.transition().duration(200).style("opacity",styConfig.listItems.defaultOpacity).style("font-weight","normal").style("list-style","none"),i.includes(e.id)||a.transition().duration(200).style("opacity",styConfig.listItems.dimmedOpacity).style("font-weight","normal").style("list-style","none")}))}function focusOnLinkAnalysis(e){e.length>0&&(d3.selectAll(".link").each((function(t,i){let n=e.includes(t.target.id);d3.select(this).transition().duration(200).attr("opacity",n?styConfig.link.activeOpacity:styConfig.link.inactiveOpacity)})),d3.selectAll(".label").each((function(t,i){d3.select(this).transition().duration(200).attr("fill-opacity",(function(t){return setNodeLabelOpacity(t,e)}))})),d3.selectAll(".node").each((function(t,i){d3.select(this).transition().duration(200).style("opacity",(function(t){return setNodeLabelOpacity(t,e)}))})),d3.selectAll(".linkArticlesListItem").each((function(t,i){let n=d3.select(this);e.includes(t.id)?n.transition().duration(200).style("opacity",styConfig.listItems.defaultOpacity):n.transition().duration(200).style("opacity",styConfig.listItems.dimmedOpacity)})),d3.selectAll(".relatedLinkLines").transition().duration(100).style("opacity",styConfig.linkLines.inactiveOpacity),setNavTip("On"))}function setNodeLabelOpacity(e,t,i){let n;return t.includes(e.id)&&(n=styConfig.nodeLabel.inArrayOpacity),t.includes(e.id)||(n=styConfig.nodeLabel.notInArrayOpacity),0===e.index&&(n=styConfig.nodeLabel.centralNodeDimmedOpacity),void 0!==i&&e.id===i.id&&(n=styConfig.nodeLabel.defaultOpacity),n}function setListItemBold(e,t){d3.selectAll(e).each((function(e,i){t===this&&d3.select(this).style("font-weight","bold").transition().duration(200).style("opacity",styConfig.listItems.defaultOpacity)}))}function resetListItemDefaults(e){d3.selectAll(e).transition().duration(200).style("opacity",styConfig.listItems.defaultOpacity).style("font-weight","normal").style("text-decoration","none")}function resetDisplayDefaultsArticleGraph(){d3.selectAll(".link").transition().duration(200).attr("opacity",styConfig.link.defaultOpacity),d3.selectAll(".label").transition().duration(200).attr("fill-opacity",styConfig.nodeLabel.defaultOpacity).style("font-weight","normal"),d3.selectAll(".node").transition().duration(200).style("opacity",styConfig.nodeLabel.defaultOpacity),d3.selectAll(".relatedLinkLines").transition().duration(200).style("opacity",styConfig.linkLines.inactiveOpacity),d3.select(".d3plus-textBox").transition().duration(200).style("opacity",styConfig.nodeLabel.defaultOpacity),resetListItemDefaults(".linkDirListItem"),resetListItemDefaults(".linkDomainListItem"),resetListItemDefaults(".linkArticlesListItem"),setNavTip("Off")}function showDomainGraph(e){d3.json(json_file).then((function(t){resetScreen();let i=getDomainData(t,e);setGlobalNodesLinks(i),showGraphPage(),setGraphMode("Hover"),setGraphType("Domain"),drawDomainSimulation(t,i),setPageTitle(e,e,"Domain Graph"),updateSidebarRight_DomainMain(t,i),updateNeighborNodes(),updateBrowser("/domain/"+i.id,e),resetDisplayDefaultsArticleGraph(),resetDisplayDefaultsDomainGraph(),d3.selectAll(".label").remove(),d3.select(".mainArticleLabelArea").remove(),updateRecentSearch({title:e,primary_domain:e},"Domain"),showAll=!1,clearSelections()}))}function getDomainData(e,t){let i={},n=searchCache.find(({domain:e})=>e===t);return i=n||getDomainDataFromJSON(e,t),i}function getDomainDataFromJSON(e,t){let i=t.toLowerCase().replace(/\s+/g,"-"),n=e.articles.nodes.filter(e=>e.domain_tags.includes(t)),a=[];n.forEach(t=>{e.articles.links.forEach(e=>{t.id===e.source&&a.push(e)})});let o=[];n.forEach(e=>{a.forEach(t=>{e.id===t.target&&o.push(t)})}),n.forEach(e=>{let t=new Set;o.forEach(i=>{e.id===i.source&&t.add(i.target),e.id===i.target&&t.add(i.source)}),e.numLinks=t.size});let l={domain:t,id:i,nodes:n,links:o};return searchCache.push(l),l}function drawDomainSimulation(e,t){let i=graphNodes.length;link=simConfig.links.selectAll(".link").data(graphLinks,(function(e){return`${e.source}-${e.target}`})),link.exit().remove(),link=link.enter().append("line").attr("stroke",styConfig.link.strokeColor).attr("stroke-width",styConfig.link.strokeWidth).attr("opacity",styConfig.link.defaultOpacity).classed("link",!0).merge(link);let n=graphNodes.map(e=>e.numLinks),a=d3.scaleLinear().domain([d3.min(n),d3.max(n)]).range([4,18]);node=simConfig.nodes.selectAll(".node").data(graphNodes,(function(e){return e.id})).attr("r",(function(e){return a(e.numLinks)})).attr("fill",(function(e){return color(e.primary_domain)})),node.exit().remove(),node=node.enter().append("circle").attr("r",(function(e){return a(e.numLinks)})).attr("fill",(function(e){return color(e.primary_domain)})).attr("stroke",styConfig.nodeLabel.strokeColor).attr("stroke-width",styConfig.nodeLabel.strokeWidth).attr("nodeID",(function(e){return e.id})).style("opacity",1).classed("node",!0).merge(node),node.on("mouseover",(function(){mouseOverDomainNode(this,"opacity")})),node.on("mouseout",(function(){mouseOutDomainNode(this,"opacity")})),node.on("click",(function(){sngClickDomainNode(this,"opacity")})),node.on("dblclick",(function(){dblClickDomainNode(this,"opacity")}));let o=0;simConfig.simulation.on("tick",(function(){o<50?(link.attr("x1",(function(e){return e.source.x})).attr("y1",(function(e){return e.source.y})).attr("x2",(function(e){return e.target.x})).attr("y2",(function(e){return e.target.y})),node.attr("cx",(function(e){return e.x})).attr("cy",(function(e){return e.y}))):simConfig.simulation.stop(),o++})),simConfig.simulation.force("charge").strength((function(){return forceStrength(i)})),simConfig.simulation.force("link").id((function(e){return e.id})).distance(100).links(graphLinks),simConfig.simulation.force("forceX").strength((function(e){return i>300?.15:.05})),simConfig.simulation.force("forceY").strength((function(e){return i>300?.15:.05})),simConfig.simulation.nodes(graphNodes),simConfig.simulation.force("collide").radius(15),simConfig.simulation.alpha(1).restart()}function setLinkDistanceDomain(e){}function updateSidebarLeft_DomainMain(e){clearSidebar(sidebarLeft);let t=sidebarLeft.append("div");setDomainIntroPanel(t),void 0!==e&&(setArticleIntroParagraph(t,"Preview",e),setArticleDomainDetails(t,e),toggleDomainIntroContent("off"))}function updateSidebarRight_DomainMain(e,t){clearSidebar(sidebarRight);let i=sidebarRight.append("div");t&&(setDomainCountPanel(i,t,e),setCentralNodesPanel(i,t,e),setDomainArticleListPanel(i,t,e))}function setDomainIntroPanel(e){let t=e.append("div").classed("panelBG",!0).attr("id","domainIntroPanel").style("margin-bottom","2em"),i=pageTitle.text().replace(" (Domain Graph)",""),n=t.append("h2").html("Domain Graph Introduction").attr("id","domainIntroHeading").classed("panelHeading",!0).classed("toggleOnBG_User",!0).style("color",(function(){return color(i)})),a='<p>The Domain Graph shows every article reasonably tagged as being part of the "'+i+"\" domain, either as a primary domain or as a secondary domain. Articles can appear in multiple domains, but are always colored by their primary domain designation.</p><p>In the graph's default state, only nodes are visible. <strong>MouseOver</strong> a node or a sidebar title to display the labels on the graph. </p><p>When a node is activated, its label is displayed next to it, and the entire graph is updated interactively: the nodes for all of its direct links are highlighted, and the rest of the graph is dimmed. The labels for each of the linked articles are displayed on the left and right sides of the graph. </p><p>Nodes are sized according the number of shared links within the domain: the larger the circle, the greater number of links that node is related to.</p>",o=t.append("div").attr("id","domainIntroContent").style("display","block");o.append("div").html(a).classed("panelParagraphText",!0),o.append("div").html("<p>Please note: this panel will collapse automatically when a node is activated.</p>").classed("panelParagraphText",!0).style("font-weight","bold"),n.on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){let e=o.style("display");"block"===e?(toggleDomainIntroContent("off"),toggleArticleIntroContent("on"),toggleDomainDetailsContent("on")):"none"===e&&(toggleDomainIntroContent("on"),toggleArticleIntroContent("off"),toggleDomainDetailsContent("off"))}))}function toggleDomainIntroContent(e){let t=d3.select("#domainIntroHeading"),i=d3.select("#domainIntroContent");"on"===e&&(i.transition().duration(500).style("display","block"),t.classed("toggleOnBG_User",!0).classed("toggleOffBG_User",!1),toggleArticleIntroContent("off"),toggleDomainDetailsContent("off")),"off"===e&&(i.transition().duration(500).style("display","none"),t.classed("toggleOnBG_User",!1).classed("toggleOffBG_User",!0),toggleArticleIntroContent("on"),toggleDomainDetailsContent("on")),clearSelections()}function setDomainCountPanel(e,t,i){e.append("div").classed("panelBG",!0).attr("id","domainCountPanel").classed("linkCountDiv",!0).append("h2").html(`<span class="badge badge-pill badge-light">${t.nodes.length}</span> Domain Articles`).classed("linkCountText",!0)}function setCentralNodesPanel(e,t,i){let n=e.append("div").classed("panelBG",!0).attr("id","domainCentralNodesPanel"),a=(n.append("h2").html("Top 5 Most Connected Domain Articles").classed("panelHeading",!0),n.append("div").attr("id","centralNodesContentArea").classed("scrollbars",!0));t.nodes.sort((e,t)=>d3.descending(e.numLinks,t.numLinks));let o=[];t.nodes.forEach((e,t)=>{t<5&&o.push(e)}),a.append("ul").selectAll(".centralNodeArticles").data(o).enter().append("li").html((function(e){return` <span class="badge badge-pill badge-light">${e.numLinks}</span> ${e.title}`})).style("color",(function(e){return color(e.primary_domain)})).classed("centralNodeArticles",!0).classed("panelListItem_numbered",!0).exit().remove(),setPanelHelp(n,"Most Connected Nodes Help","panelHelpRightSideBar","#centralNodesHelp").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){toggleHelpPage("#graphHelpCentralNodes")}));let l=d3.selectAll(".centralNodeArticles");l.on("mouseover",(function(){mouseOverDomainNode(this,"opacity")})),l.on("mouseout",(function(){mouseOutDomainNode(this,"opacity")})),l.on("click",(function(){sngClickDomainNode(this,"opacity")})),l.on("dblclick",(function(){dblClickDomainNode(this,"opacity")}))}function setDomainArticleListPanel(e,t,i){let n=e.append("div");n.classed("panelBG",!0).attr("id","domainArticlesPanel"),n.append("h2").text("List of All Domain Articles").classed("panelHeading",!0);let a=n.append("div").classed("domainArticleList",!0).attr("id","domainArticleListContentArea").classed("scrollbars",!0);t.nodes.sort((e,t)=>d3.ascending(e.title,t.title)),a.append("ul").selectAll(".domainArticle").data(t.nodes).enter().append("li").html((function(e){return` <span class="badge badge-pill badge-light">${e.numLinks}</span> ${e.title}`})).style("color",(function(e){return color(e.primary_domain)})).classed("domainArticle",!0).classed("panelListItem_numbered",!0).exit().remove(),setPanelHelp(n,"Domain Articles Help","panelHelpRightSideBar","#domainArticlesHelp").on("mouseover",(function(){activateItemLink(this)})).on("mouseout",(function(){deActivateItemLink(this)})).on("click",(function(){toggleHelpPage("#graphHelpListOfDomainArticles")}));let o=d3.selectAll(".domainArticle");o.on("mouseover",(function(){mouseOverDomainNode(this,"opacity")})),o.on("mouseout",(function(){mouseOutDomainNode(this,"opacity")})),o.on("click",(function(){sngClickDomainNode(this,"opacity")})),o.on("dblclick",(function(){dblClickDomainNode(this,"opacity")}))}function exploreDomainNode(e){focusOnDomainArticle(e.datum()),updateSidebarLeft_DomainMain(e.datum()),currentDomainCentralNode=getDomainCentralNode(),setListItemStyle_DomainCentralNode(currentDomainCentralNode),setListItemStyle_NeighborNodeOpacity(),exploreMode=!0}function dblClickDomainNode(e,t){let i=d3.select(e);if("opacity"===t&&i.style(t)>styConfig.listItems.dimmedOpacity){i.style("cursor","pointer").style("font-weight","bold"),resetDisplayDefaultsArticleGraph(),showArticleGraph(i.datum().title)}}function sngClickDomainNode(e,t){let i=d3.select(e);"opacity"===t&&i.style(t)>styConfig.listItems.dimmedOpacity&&sngClickDomainNodeActions(e)}function sngClickDomainNodeActions(e){let t=d3.select(e),i=t.datum().title,n=t.style("font-weight"),a=d3.select("#articleIntroParagraphPanel").node(),o="";toggleDomainIntroContent("off"),d3.event.shiftKey?(showArticleDetailsPage(t.datum()),updateSidebarLeft_DomainMain(t.datum()),clearSelections()):(a&&(o=d3.select("#articlePreviewTitle").node().innerHTML),"normal"===n||"400"===n?(i!==o&&updateSidebarLeft_DomainMain(t.datum()),focusOnDomainArticle(t.datum()),currentDomainCentralNode=getDomainCentralNode(),setListItemStyle_DomainCentralNode(currentDomainCentralNode),setListItemStyle_NeighborNodeOpacity(),t.classed("domainMainNode",!0).transition().duration(200).style("font-weight","bold"),setNavTip("On"),setGraphMode("Explore")):(t.classed("domainMainNode",!1).transition().duration(200).style("font-weight","normal"),setGraphMode("Hover"),setNavTip("Off")))}function mouseOverDomainNode(e,t){let i=d3.select(e);"opacity"===t&&i.style(t)>styConfig.listItems.dimmedOpacity&&mouseOverDomainNodeActions(e)}function mouseOverDomainNodeActions(e){let t=d3.select(e).classed("domainMainNode",!0);currentDomainCentralNode=getDomainCentralNode(),activateItemLink(e),setArticleDetailsPage(t.datum());let i=t.datum().title;if(exploreMode||(activateItemLink(e),focusOnDomainArticle(t.datum()),updateSidebarLeft_DomainMain(t.datum()),setNavTip("On")),exploreMode){let e=d3.select("#articlePreviewTitle").node().innerHTML,n=d3.selectAll(".node").filter((function(e,i){return e.id===t.datum().id}));if(+n.style("opacity")>=styConfig.nodeLabel.neighborNodeOpacity){n.style("opacity",styConfig.nodeLabel.defaultOpacity);let a=getDomainLabelLocationData(getD3PlusLabel(t.datum().id));n.datum().id!==currentDomainCentralNode.id&&drawDomainLinkLine(a,n),priorNodeCircle_ListItem=n,e!==i&&updateSidebarLeft_DomainMain(t.datum())}}}function mouseOutDomainNode(e,t){deActivateItemLink(e);let i=d3.select(e);"opacity"===t&&i.style(t)>styConfig.listItems.dimmedOpacity&&mouseOutDomainNodeActions(e)}function mouseOutDomainNodeActions(e){if(exploreMode||(resetDisplayDefaultsDomainGraph(),toggleDomainIntroContent("off")),exploreMode){let e=d3.select("#articlePreviewTitle").node().innerHTML,t=d3.selectAll(".domainArticle").filter((function(e,t){return"bold"===d3.select(this).style("font-weight")})),i=t.datum().title;t.data().length>0&&e!==i&&(updateSidebarLeft_DomainMain(t.datum(),"Preview"),priorNodeCircle_ListItem&&priorNodeCircle_ListItem.style("opacity",styConfig.nodeLabel.neighborNodeOpacity),priorNodeCircle_ListItem=null),d3.selectAll(".relatedLinkLines").style("opacity",styConfig.linkLines.inactiveOpacity)}}function updateNeighborNodes(){neighborNodes.length=0,graphLinks.forEach((function(e){neighborNodes[e.source.id+"-"+e.target.id]=!0,neighborNodes[e.target.id+"-"+e.source.id]=!0}))}function isNeighborNode(e,t){return e==t||neighborNodes[e+"-"+t]}function focusOnDomainArticle(e){d3.selectAll(".link").transition().duration(300).attr("opacity",(function(t){return t.source.id===e.id||t.target.id===e.id?styConfig.link.activeDomainOpacity:styConfig.link.inactiveDomainOpacity})),d3.selectAll(".node").transition().duration(300).style("opacity",(function(t){return e.id===t.id?styConfig.nodeLabel.defaultOpacity:isNeighborNode(e.id,t.id)?styConfig.nodeLabel.neighborNodeOpacity:styConfig.nodeLabel.notInArrayOpacity})),positionRelatedDomainLabels(e),toggleDomainIntroContent("off")}function getDomainCentralNode(){let e,t=d3.select(".mainDomainNode").select("g").node();return e=null!==t?getDomainNodeFromD3Plus(t):null,e}function setListItemStyle_DomainCentralNode(e){"null"!==e&&(d3.selectAll(".centralNodeArticles").each((function(t){if(t.id===e.id){d3.select(this).transition().duration(200).style("font-weight","bold")}else{d3.select(this).transition().duration(200).style("font-weight","normal")}})),d3.selectAll(".domainArticle").each((function(t){if(t.id===e.id){d3.select(this).transition().duration(200).style("font-weight","bold")}else{d3.select(this).transition().duration(200).style("font-weight","normal")}})),d3.selectAll(".node").transition().duration(300).style("opacity",(function(t){return t.id===e.id?styConfig.nodeLabel.defaultOpacity:isNeighborNode(e.id,t.id)?styConfig.nodeLabel.neighborNodeOpacity:styConfig.nodeLabel.notInArrayOpacity})).style("font-weight",(function(t){return t.id===e.id?"bold":"normal"})))}function setListItemStyle_NeighborNodeOpacity(){let e=d3.selectAll(".d3plus-textBox").data().map(e=>e.data.title);d3.selectAll(".centralNodeArticles").each((function(t){e.includes(t.title)?d3.select(this).transition().duration(200).style("opacity",styConfig.listItems.defaultOpacity):d3.select(this).transition().duration(200).style("opacity",styConfig.listItems.dimmedOpacity)})),d3.selectAll(".domainArticle").each((function(t){e.includes(t.title)?d3.select(this).transition().duration(200).style("opacity",styConfig.listItems.defaultOpacity):d3.select(this).transition().duration(200).style("opacity",styConfig.listItems.dimmedOpacity)}))}function getLabelObj(e,t){let i=+e.attr("cx"),n=+e.attr("cy"),a=+e.attr("r"),o=e.attr("nodeID"),l=t.primary_domain,r=t.title;return{id:o,cx:i,cy:n,r:a,text:r,title:r,primaryDomain:l}}function positionRelatedDomainLabels(e){let t=simConfig.domainLabels;t.html("").style("opacity",styConfig.nodeLabel.defaultOpacity);let i=[],n=[];d3.selectAll(".node").each((function(t,a){let o=d3.select(this),l=o.attr("nodeID");e.id===l?i.push(getLabelObj(o,t)):isNeighborNode(e.id,l)&&n.push(getLabelObj(o,t))})),n.sort((e,t)=>d3.ascending(e.text,t.text));let a=parseInt(n.length/2),o=n.slice(0,a),l=n.slice(a);d3.extent(o,e=>e.cy),d3.extent(l,e=>e.cy),t.append("g").classed("mainDomainNode",!0);(new d3plus.TextBox).data(i).select(".mainDomainNode").y((function(e){return e.cy-e.r})).x((function(e){return setDomainXpos(e.cx,e.r,175)})).fontFamily("proxima-nova, sans-serif").fontSize(18).fontWeight("bold").fontColor((function(e){return color(e.primaryDomain)})).verticalAlign("top").textAnchor((function(e){return e.cx>0?"end":"start"})).width(175).lineHeight(20).height(150).render();t.append("g").attr("x","-400").attr("y","-400").classed("domainLabelLeftGroup",!0);(new d3plus.TextBox).data(o).select(".domainLabelLeftGroup").y((function(e,t){return placeLabel(t,o)})).x(-475).fontFamily("proxima-nova, sans-serif").fontSize((function(e){return o.length>30?14:15})).fontColor((function(e){return color(e.primaryDomain)})).verticalAlign("top").textAnchor("start").width(350).lineHeight(14).height(35).render();t.append("g").attr("x","400").attr("y","-400").classed("domainLabelRightGroup",!0);(new d3plus.TextBox).data(l).select(".domainLabelRightGroup").y((function(e,t){return placeLabel(t,l)})).x(130).textAnchor("end").fontFamily("proxima-nova, sans-serif").fontSize((function(e){return o.length>30?14:15})).fontColor((function(e){return color(e.primaryDomain)})).verticalAlign("top").width(350).lineHeight(14).height(40).render(),d3.select(".mainDomainNode").transition().duration(50).style("fill-opacity",styConfig.nodeLabel.defaultOpacity);let r=d3.selectAll(".d3plus-textBox");r.transition().duration(200).style("fill-opacity",styConfig.nodeLabel.defaultOpacity),r.on("mouseover",(function(){!function(e){activateItemLink(e),currentDomainCentralNode=getDomainCentralNode();let t=getDomainNodeFromD3Plus(e),i=d3.selectAll(".node").filter((function(e,i){return e.id===t.id}));i.style("opacity",styConfig.nodeLabel.defaultOpacity);let n=getDomainLabelLocationData(d3.select(e));t.title!==currentDomainCentralNode.title&&(drawDomainLinkLine(n,i),updateSidebarLeft_DomainMain(t));priorNodeCircle=i}(this)})),r.on("mouseout",(function(){!function(e){deActivateItemLink(e);let t=getDomainNodeFromD3Plus(e);d3.selectAll(".relatedLinkLines").style("opacity",0),t.title!==currentDomainCentralNode.title&&"block"!==articleDetailsPage.style("display")&&(priorNodeCircle.style("opacity",styConfig.nodeLabel.neighborNodeOpacity),updateSidebarLeft_DomainMain(currentDomainCentralNode))}(this)})),r.on("click",(function(){!function(e){d3.selectAll(".relatedLinkLines").style("opacity",0);let t=getDomainNodeFromD3Plus(e),i=getDomainCentralNode();d3.event.shiftKey?(showArticleDetailsPage(t),updateSidebarLeft_DomainMain(t),clearSelections()):setTimeout((function(){s||(t.title!==i.title?(updateSidebarLeft_DomainMain(t),focusOnDomainArticle(t),setListItemStyle_DomainCentralNode(t),setListItemStyle_NeighborNodeOpacity()):(setNavTip("Off"),setGraphMode("Hover")))}),300)}(this)})),r.on("dblclick",(function(){!function(e){s=!0;let t=getDomainNodeFromD3Plus(e);resetDisplayDefaultsDomainGraph(),showArticleGraph(t.title)}(this)}));let s=!1}function placeLabel(e,t){let i,n,a=t.length;a<=10&&(i=-200,n=200),a>10&&a<=20&&(i=-250,n=225),a>20&&a<=30&&(i=-275,n=275),a>30&&(i=-300,n=375);let o,l=Math.abs(i)+Math.abs(n);return a<=30&&(o=l/a),a>30&&a<=38&&(o=l/a*.6+5),a>38&&(o=l/a*.03+14),i+e*o}function getDomainLabelLocationData(e){let t=e.datum().x,i=e.datum().y,n=e.node().getBBox().height,a=e.node().getBBox().width;return{startX:t<0?t+a+5:t+(350-a)+5,startY:i+n/2}}function drawDomainLinkLine(e,t){let i=+t.attr("cx"),n=+t.attr("cy"),a=t.datum().primary_domain,o=simConfig.relatedLinks;o.html(""),o.style("opacity",styConfig.linkLines.domainGraphOpacity),o.append("line").attr("x1",e.startX).attr("y1",e.startY).attr("x2",i).attr("y2",n).attr("id","test").style("stroke",(function(){return color(a)})).classed("relatedLinkLines",!0).transition().duration(1e3).style("opacity",0)}function getD3PlusLabel(e){return d3.selectAll(".d3plus-textBox").filter((function(t){return t.id===e}))}function getD3PlusIDString(e){return"d3plus-textbox-"+e.replace(/\//g,"")}function getDomainNodeFromD3Plus(e){let t;if(void 0!==e.id){let i=e.id.substring(15).replace(/entries/,"/entries/");i+="/",t=graphNodes.filter(e=>e.id===i)[0]}else t="None";return t}function resetDisplayDefaultsDomainGraph(){"Domain"===graphType&&updateSidebarLeft_DomainMain();d3.selectAll(".link").transition().duration(200).attr("opacity",styConfig.link.defaultOpacity),d3.selectAll(".node").transition().duration(200).style("opacity",styConfig.nodeLabel.defaultOpacity),d3.selectAll(".relatedLinkLines").transition().duration(200).style("opacity",styConfig.linkLines.inactiveOpacity);d3.selectAll(".d3plus-textBox").transition().duration(200).style("opacity",styConfig.nodeLabel.defaultOpacity);let e=simConfig.domainLabels;e.transition().duration(200).style("opacity",styConfig.nodeLabel.inactiveOpacity),e.html(""),setNavTip("Off")}function resetDomainMenuOpacity(){d3.selectAll(".centralNodeArticles").transition().duration(200).style("opacity",1).style("font-weight","normal"),d3.selectAll(".domainArticle").transition().duration(200).style("opacity",1).style("font-weight","normal")}function combineLinks(e,t,i,n){let a=[];return t.forEach(t=>{let i={source:e,target:t,direction:"bi"};a.push(i)}),i.forEach(t=>{let i={source:e,target:t,direction:"out"};a.push(i)}),n.forEach(t=>{let i={source:e,target:t,direction:"in"};a.push(i)}),a}function intersection(e,t){let i=new Set(e),n=new Set(t),a=new Set;for(let e of n)i.has(e)&&a.add(e);return a}function symmetricDifference(e,t){new Set(e);let i=new Set(t),n=new Set(e);for(let e of i)n.has(e)?n.delete(e):n.add(e);return n}function forceStrength(e){let t;return e<=10&&(t=-300),e>10&&e<=20&&(t=-260),e>20&&e<=30&&(t=-240),e>30&&e<=40&&(t=-200),e>40&&e<=50&&(t=-160),e>50&&e<=60&&(t=-120),e>60&&e<=70&&(t=-80),e>70&&e<=80&&(t=-70),e>80&&e<=90&&(t=-40),e>90&&(t=-20),t}function ticksByNodeCount(e){let t;return e<=10&&(t=50),e>20&&e<=20&&(t=80),e>30&&e<=30&&(t=100),e>40&&e<=40&&(t=150),e>50&&e<=60&&(t=200),e>60&&e<=70&&(t=250),e>70&&e<=80&&(t=200),e>80&&e<=90&&(t=250),e>90&&(t=100),t}function angle(e,t,i,n){var a=n-t,o=i-e,l=Math.atan2(a,o);return l*=180/Math.PI}function rotateLabel(e,t,i){return rotateVal=linkAngles[e],rotateReturn=t>0?`rotate(${rotateVal},${t},${i})`:`rotate(${rotateVal+180},${t},${i})`,rotateReturn}function setArticleXpos(e,t){return returnX=e>0?e+12:e-t-12,returnX}function setDomainXpos(e,t,i){let n;return n=e>0?e-(void 0===i?0:i)-t-5:e+t+5,n}function setDomainYpos(e,t){return e-t}function setDomainXpos_old(e,t,i){let n,a=void 0===i?0:i/2;return n=e>0?e-5-a-t:e+5+a+t,n}function setDomainYpos_old(e,t,i){let n;return n=e>0?e+i/2+t+5:e-i/2-t,n}function color(e){let t="";switch(e){case"Thinker":t="rgb(180,255,249)";break;case"Aesthetics and Philosophy of Art":t="rgb(184, 108, 237)";break;case"Philosophy of Religion":t="rgb(156, 20, 252)";break;case"Ethics":t="rgb(230, 97, 97)";break;case"Social and Political Philosophy":t="rgb(192, 2, 96)";break;case"Philosophy of Law":t="rgb(251, 3, 114)";break;case"Philosophy of Economics":t="rgb(238, 50, 170)";break;case"Feminist Philosophy":t="rgb(238, 4, 4)";break;case"Continental Philosophy":t="rgb(170, 50, 3)";break;case"Chinese Philosophy":t="rgb(235, 66, 3)";break;case"Japanese Philosophy":t="rgb(191, 88, 12)";break;case"Indian Philosophy":t="rgb(255, 159, 101)";break;case"Latin American and Iberian Philosophy":t="rgb(237, 100, 68)";break;case"Arabic and Islamic Philosophy":t="rgb(255, 128, 0)";break;case"African and African-American Philosophy":t="rgb(255, 165, 1)";break;case"Judaic Philosophy":t="rgb(255, 165, 1)";break;case"Logic":t="rgb(20,172,100)";break;case"Philosophy of Mathematics":t="rgb(0,255,80)";break;case"Philosophy of Computer Science":t="rgb(155,235,135)";break;case"Philosophy of Language":t="rgb(172,247,76)";break;case"Metaphysics":t="rgb(2,255,208)";break;case"Epistemology":t="rgb(250,250,147)";break;case"Philosophy of Mind":t="rgb(43, 162, 162)";break;case"Philosophy of Science":t="rgb(0,111,255)";break;case"Philosophy of Biology":t="rgb(10,205,255)";break;case"Philosophy of Physics":t="rgb(70,144,255)";break;case"Default Page":t="rgb(240, 219, 0)";break}return t}function getRandom(){let e=getRandomIntInclusive(0,allEntries.length);e<=allEntries.length-1?showArticleGraph(allEntries[e].title):showDomainGraph(allEntries[e].title)}function getRandomIntInclusive(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function clearSelections(){window.getSelection().removeAllRanges()}function getScreenProperties(){}getScreenProperties(),startVisualization(),window.addEventListener("popstate",(function(e){processURL()}),!1),window.addEventListener("hashchange",(function(){processURL()}),!1);